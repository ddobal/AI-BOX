---
layout: post
title: "이미지 전처리 파이프라인 개선기"
date: 2025-12-04
category: "Vision Engineering"
tags: [preprocessing, augmentation, pipeline]
---

이 글은 이미지 분류/검출 모델을 학습시키면서,  
**전처리 파이프라인을 어떻게 바꾸었을 때 성능이 달라지는지**  
실제로 겪은 경험을 적어둔 기록이다.

---

## 1. 초기 파이프라인

처음에는 아주 단순하게 시작했다.

- Resize → CenterCrop → Normalize
- Augmentation은 거의 없이,  
  “일단 베이스라인을 보자”는 느낌으로 구성

이 상태에서 모델을 학습해보니:

- 학습 데이터에 대해서는 금방 99% 이상까지 올라가지만  
- 검증 셋에서는 생각보다 성능이 잘 나오지 않았다.  
  → **Overfitting**의 전형적인 패턴.

---

## 2. Augmentation 도입

이후 아래와 같은 Augmentation을 단계적으로 추가했다.

- RandomHorizontalFlip
- ColorJitter (brightness, contrast, saturation)
- RandomRotation, RandomResizedCrop

변경 후 관찰:

- 학습 속도는 다소 느려졌지만  
- 검증 셋 성능이 안정적으로 올라가는 모습을 확인했다.
- 다만 ColorJitter 강도를 너무 높게 주면  
  데이터가 “원본과 너무 다른 세계”가 되어 오히려 성능이 떨어지기도 했다.

---

## 3. 과한 전처리의 부작용

한 번은 “Augmentation을 많이 넣으면 좋겠지?” 라는 생각으로  
다양한 랜덤 노이즈, 블러를 잔뜩 넣어본 적이 있다.

- 결과:
  - 학습 과정이 매우 불안정해지고  
  - Loss가 줄어드는 패턴도 들쭉날쭉
  - 실제 이미지와 괴리가 큰 변형은 오히려 해가 된다는 걸 느꼈다.

그래서 “**현실에서 있을 법한 변형만 남기자**”는 원칙을 세웠다.

---

## 4. 최종 파이프라인 (학습용)

다듬고 난 뒤의 파이프라인은 대략 다음과 같았다.

- Resize (긴 변 기준)
- RandomResizedCrop (약간의 스케일 변화 허용)
- RandomHorizontalFlip
- 가벼운 ColorJitter
- Normalize

그리고 **검증/테스트**에는

- Resize + CenterCrop + Normalize  
  외에는 아무 것도 하지 않았다.

---

## 5. 정리 및 배운 점

- 전처리는 “많이 넣는 것”이 아니라,  
  **데이터의 실제 분포를 잘 반영하는 정도만 넣는 것**이 중요하다.
- 파이프라인을 바꿀 때는  
  한 번에 여러 개를 바꾸기보다는  
  **하나씩 추가 → 변화 관찰** 방식이 더 도움이 됐다.
- 앞으로는
  - AutoAugment, RandAugment 같은 기법도  
    조금씩 실험해 볼 계획이다.
